<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        li {
            width: 50%;
            margin: auto;
            background-color: orange;
            border: 1px red solid;
            list-style-type: none;
        }

        .green {
            background-color: green;
        }

        .gray {
            background-color: gray;
        }
    </style>
</head>

<body>
    
    <ul id="list-drag-ul">
        <li draggable="true" class="green f1" >
        <img src="https://fakeimg.pl/300x200/200">    
        </li>
        <li draggable="true" class="f2">2</li>
        <li draggable="true" class="green f3">3</li>
        <li draggable="true" class="f4">4</li>
        <li draggable="true" class="green f5">5</li>
    </ul>
    <script>

        /*
            拖放事件重點: 
            ondragenter：元素被拖動到放置目標上觸發
            ondragover：放置目標範圍內移動時持續觸發
            ondragleave：拖出放置目標範圍觸發
            ondrop：放到放置目標中觸發

        */
        var list_drag_ul = document.getElementById("list-drag-ul");

        list_drag_ul.ondragover = function (event)  //當開始拖動
        {
            event.preventDefault();
        };

        var draging; //儲存被拖動的元素
        list_drag_ul.ondragstart = function (event) 
        {
            draging = event.target;
        }

        list_drag_ul.ondrop = function (event)  //當拖動的目標被放下
        {
            var target = event.target; //放下 拖動的元素時候 , 放下目標
            if (target.nodeName === "LI" && target !== draging)
             {
                if (getIndex(draging) < getIndex(target)) {
                    target.parentNode.insertBefore(draging, target.nextSibling);
                } else {
                    target.parentNode.insertBefore(draging, target);
                }
            }
        };

        function getIndex(el) 
        {
            var index = 0;
            if (!el || !el.parentNode) {
                return -1;
            }
            while (el = el.previousElementSibling) {
                index++;
            }
            return index;
        }
    </script>

</body>

</html>